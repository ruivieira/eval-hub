apiVersion: batch/v1
kind: Job
metadata:
  name: eval-job-001-mmlu
  namespace: evalhub
  labels:
    app: "evalhub"
    component: "evaluation-job"
    job_id: "001"
    provider_id: "lm_evaluation_harness"
    benchmark_id: "mmlu"
spec:
  backoffLimit: 2
  ttlSecondsAfterFinished: 3600
  template:
    metadata:
      labels:
        app: "evalhub"
        component: "evaluation-job"
        job_id: "001"
        provider_id: "lm_evaluation_harness"
        benchmark_id: "mmlu"
    spec:
      restartPolicy: Never
      containers:
        - name: adapter
          image: quay.io/eval-hub/adapter:latest
          imagePullPolicy: IfNotPresent
          command:
            - /path/to/program
          env:
            - name: JOB_ID
              value: "001"
          resources:
            requests:
              cpu: "250m"
              memory: "512Mi"
            limits:
              cpu: "1"
              memory: "2Gi"
          securityContext:
            allowPrivilegeEscalation: false
            runAsNonRoot: true
            runAsUser: 1000
            runAsGroup: 1000
            capabilities:
              drop:
                - "ALL"
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - name: job-spec
              mountPath: /meta/job.json
              subPath: job.json
              readOnly: true
            - name: data
              mountPath: /data
      volumes:
        - name: job-spec
          configMap:
            name: eval-job-001-mmlu-spec
        - name: data
          emptyDir: {}
