openapi: 3.1.0
info:
  title: Eval Hub
  description: API REST server for evaluation backend orchestration
  version: 0.0.1
  contact:
    name: API Support
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
servers:
  - url: http://localhost:8080
    description: Local development server
  - url: https://api.example.org
    description: Production server
security: []
tags:
  - name: Evaluations
    description: Evaluation job management endpoints
  - name: Benchmarks
    description: Benchmark management endpoints
  - name: Providers
    description: Evaluation provider endpoints
  - name: Health
    description: Health check endpoints
paths:
  /api/v1/health:
    get:
      summary: Health Check
      description: Health check endpoint.
      operationId: health_check_api_v1_health_get
      tags:
        - Health
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/v1/evaluations/jobs:
    post:
      tags:
        - Evaluations
      summary: Create Evaluation
      description: Create and execute evaluation request using the simplified benchmark schema.
      operationId: create_evaluation_api_v1_evaluations_jobs_post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EvaluationRequest'
      responses:
        '202':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EvaluationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    get:
      tags:
        - Evaluations
      summary: List Evaluations
      description: List all evaluation requests.
      operationId: list_evaluations_api_v1_evaluations_jobs_get
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            maximum: 100
            minimum: 1
            description: Maximum number of evaluations to return
            default: 50
            title: Limit
          description: Maximum number of evaluations to return
        - name: offset
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            description: Offset for pagination
            default: 0
            title: Offset
          description: Offset for pagination
        - name: status_filter
          in: query
          required: false
          schema:
            type: string
            description: Filter by status
            title: Status Filter
          description: Filter by status
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEvaluations'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/v1/evaluations/jobs/{id}:
    get:
      tags:
        - Evaluations
      summary: Get Evaluation Status
      description: Get the status of an evaluation request.
      operationId: get_evaluation_status_api_v1_evaluations_jobs__id__get
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            title: Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EvaluationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags:
        - Evaluations
      summary: Cancel Evaluation
      description: Cancel a running evaluation.
      operationId: cancel_evaluation_api_v1_evaluations_jobs__id__delete
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            title: Id
        - name: hard_delete
          in: query
          required: false
          schema:
            type: boolean
            description: If `true`, delete the evaluation job permanently so that `GET /api/v1/evaluations/jobs/{id}` will return a 404.
            default: false
            title: Hard Delete
      responses:
        '204':
          description: Successful Response
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/v1/evaluations/providers:
    get:
      tags:
        - Providers
      summary: List Providers
      description: List all registered evaluation providers.
      operationId: list_providers_api_v1_evaluations_providers_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListProvidersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/v1/evaluations/providers/{provider_id}:
    get:
      tags:
        - Providers
      summary: Get Provider
      description: Get details of a specific provider.
      operationId: get_provider_api_v1_evaluations_providers__provider_id__get
      parameters:
        - name: provider_id
          in: path
          required: true
          schema:
            type: string
            title: Provider Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Provider'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /api/v1/evaluations/benchmarks:
    get:
      tags:
        - Benchmarks
      summary: List All Benchmarks
      description: List all available benchmarks across providers (similar to Llama Stack format).
      operationId: list_all_benchmarks_api_v1_evaluations_benchmarks_get
      parameters:
        - name: provider_id
          in: query
          required: false
          schema:
            type: string
            description: Filter by provider ID
            title: Provider Id
          description: Filter by provider ID
        - name: category
          in: query
          required: false
          schema:
            type: string
            description: Filter by benchmark category
            title: Category
          description: Filter by benchmark category
        - name: tags
          in: query
          required: false
          schema:
            type: string
            description: Filter by tags (comma-separated)
            title: Tags
          description: Filter by tags (comma-separated)
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListBenchmarksResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
components:
  schemas:
    HealthResponse:
      properties:
        status:
          type: string
          title: Status
          description: Overall health status
        timestamp:
          type: string
          format: date-time
          title: Timestamp
          description: Health check timestamp
      type: object
      required:
        - status
        - timestamp
      title: HealthResponse
      description: Health check response.
    APIError:
      type: object
      description: Error response for the API.
      properties:
        message:
          type: string
          description: The error message.
          title: Message
        message_code:
          type: string
          description: A message code for the error.
          title: Message Code
        trace:
          type: string
          description: The trace id of the request.
          title: Trace
      title: API Error
      required:
        - message
        - message_code
        - trace
    PaginationLink:
      properties:
        href:
          type: string
          title: Href
          description: Link URL
      additionalProperties: true
      type: object
      required:
        - href
      title: PaginationLink
      description: Hypermedia link used for pagination.
    ErrorMessage:
      type: object
      properties:
        message:
          type: string
          description: Details of the error.
          title: Message
        message_code:
          type: string
          description: Code for the error
          title: Message Code
      additionalProperties: true
      required:
        - message
        - message_code
      title: ErrorMessage
      description: Error message for a job.
    RunStatus:
      properties:
        name:
          type: string
          title: Name
          description: User-provided benchmark name
        state:
          type: string
          title: State
          description: Run state (pending, running, success, failed)
        message:
          $ref: '#/components/schemas/ErrorMessage'
        logs_path:
          type: string
          title: Logs Path
          description: Optional path to run-specific logs
      additionalProperties: true
      type: object
      required:
        - name
        - state
      title: RunStatus
      description: Status information for an individual benchmark run.
    Status:
      properties:
        state:
          type: string
          title: State
          description: Overall state of the request
          enum:
            - pending
            - running
            - completed
            - partially_failed
            - failed
            - cancelled
        message:
          $ref: '#/components/schemas/ErrorMessage'
        logs_path:
          type: string
          title: Logs Path
          description: Optional path to system logs
        runs:
          items:
            $ref: '#/components/schemas/RunStatus'
          type: array
          title: Runs
          description: Status for each benchmark run
      additionalProperties: true
      type: object
      required:
        - state
      title: Status
      description: Overall status for an evaluation request.
    ResourceInfo:
      type: object
      properties:
        id:
          type: string
          title: Id
          description: Unique evaluation request ID
        status:
          $ref: '#/components/schemas/Status'
          description: Current status of the request
        created_at:
          type: string
          format: date-time
          title: Created At
          description: Creation timestamp
        completed_at:
          type: string
          format: date-time
          title: Completed At
          description: Completion timestamp
      required:
        - id
        - status
        - created_at
      title: ResourceInfo
      description: Metadata about the evaluation resource.
    MLFlowExperimentId:
      type: string
      description: MLFlow experiment ID
      title: Mlflow Experiment Id
    EvaluationResource:
      allOf:
        - $ref: '#/components/schemas/ResourceInfo'
        - type: object
          properties:
            mlflow_experiment_id:
              $ref: '#/components/schemas/MLFlowExperimentId'
      title: EvaluationResource
      description: Resource information for an evaluation.
    BenchmarkResultPayload:
      properties:
        name:
          type: string
          title: Name
          description: Benchmark name
        metrics:
          additionalProperties:
            anyOf:
              - type: number
              - type: integer
              - type: string
          type: object
          title: Metrics
          description: Benchmark metrics
        artifacts:
          additionalProperties:
            type: string
          type: object
          title: Artifacts
          description: Benchmark artifacts
        mlflow_run_id:
          type: string
          title: Mlflow Run Id
          description: MLFlow run ID
      additionalProperties: true
      type: object
      required:
        - name
      title: BenchmarkResultPayload
      description: Result payload for a single benchmark.
    ResultsPayload:
      properties:
        benchmarks:
          items:
            $ref: '#/components/schemas/BenchmarkResultPayload'
          type: array
          title: Benchmarks
          description: List of benchmark results
        aggregated_metrics:
          additionalProperties:
            anyOf:
              - type: number
              - type: integer
              - type: string
          type: object
          title: Aggregated Metrics
          description: Aggregated metrics across benchmarks
        mlflow_experiment_url:
          type: string
          title: Mlflow Experiment Url
          description: Link to the MLFlow experiment
      additionalProperties: true
      type: object
      title: ResultsPayload
      description: Container for evaluation results.
    EvaluationResponseResults:
      type: object
      properties:
        resource:
          $ref: '#/components/schemas/EvaluationResource'
        results:
          $ref: '#/components/schemas/ResultsPayload'
      title: EvaluationResponseResults
      description: Response payload for evaluation requests.
    Model:
      properties:
        url:
          type: string
          title: Url
          description: Model endpoint URL
        name:
          type: string
          title: Name
          description: Model name/identifier
      additionalProperties: false
      type: object
      required:
        - url
        - name
      title: Model
      description: Model specification for evaluation requests.
    BenchmarkConfig:
      properties:
        benchmark_id:
          type: string
          title: Benchmark Id
          description: Benchmark identifier
        provider_id:
          type: string
          title: Provider Id
          description: Provider identifier
        config:
          additionalProperties: true
          type: object
          title: Config
          description: Benchmark configuration including num_fewshot, limit, batch_size, etc.
      additionalProperties: false
      type: object
      required:
        - benchmark_id
        - provider_id
      title: BenchmarkConfig
      description: New simplified benchmark specification.
    ExperimentConfig:
      properties:
        name:
          type: string
          title: Name
          description: Experiment name for MLFlow tracking
        tags:
          additionalProperties:
            type: string
          type: object
          title: Tags
          description: Tags for the evaluation experiment
      additionalProperties: false
      type: object
      required:
        - name
      title: ExperimentConfig
      description: Configuration for MLFlow experiment tracking.
    EvaluationRequest:
      properties:
        model:
          $ref: '#/components/schemas/Model'
          description: Model specification for evaluation
        benchmarks:
          items:
            $ref: '#/components/schemas/BenchmarkConfig'
          type: array
          title: Benchmarks
          description: List of benchmarks to evaluate
        experiment:
          $ref: '#/components/schemas/ExperimentConfig'
          description: Experiment configuration for MLFlow tracking
        timeout_minutes:
          type: integer
          title: Timeout Minutes
          description: Timeout for the entire evaluation
          default: 60
        retry_attempts:
          type: integer
          title: Retry Attempts
          description: Number of retry attempts on failure
          default: 3
        custom:
          additionalProperties: true
          type: object
          title: Custom
          description: Custom fields for additional request data
      type: object
      required:
        - model
        - benchmarks
      title: EvaluationRequest
      description: Simplified evaluation request using the new schema.
    EvaluationResponse:
      allOf:
        - $ref: '#/components/schemas/EvaluationResponseResults'
        - $ref: '#/components/schemas/EvaluationRequest'
      unevaluatedProperties: false
      title: EvaluationResponse
      description: Response payload for evaluation requests.
    PaginatedEvaluations:
      properties:
        first:
          $ref: '#/components/schemas/PaginationLink'
          description: Link to the first page
        next:
          $ref: '#/components/schemas/PaginationLink'
          description: Link to the next page, if available
        limit:
          type: integer
          title: Limit
          description: Page size used for this response
        total_count:
          type: integer
          title: Total Count
          description: Total number of evaluations
        items:
          items:
            $ref: '#/components/schemas/EvaluationResponse'
          type: array
          title: Items
          description: Evaluations returned for this page
      type: object
      required:
        - first
        - limit
        - total_count
      title: PaginatedEvaluations
      description: Paginated list response for evaluation resources.
    ProviderSummary:
      additionalProperties: true
      type: object
    ListProvidersResponse:
      properties:
        providers:
          items:
            $ref: '#/components/schemas/ProviderSummary'
          type: array
          title: Providers
          description: List of available providers
        total_providers:
          type: integer
          title: Total Providers
          description: Total number of providers
        total_benchmarks:
          type: integer
          title: Total Benchmarks
          description: Total number of benchmarks across all providers
      additionalProperties: true
      type: object
      required:
        - providers
        - total_providers
        - total_benchmarks
      title: ListProvidersResponse
      description: Response for listing all providers.
    Provider:
      additionalProperties: true
      type: object
    ListBenchmarksResponse:
      properties:
        benchmarks:
          items:
            additionalProperties: true
            type: object
          type: array
          title: Benchmarks
          description: List of all available benchmarks
        total_count:
          type: integer
          title: Total Count
          description: Total number of benchmarks
        providers_included:
          items:
            type: string
          type: array
          title: Providers Included
          description: List of provider IDs included in the response
      additionalProperties: true
      type: object
      required:
        - benchmarks
        - total_count
        - providers_included
      title: ListBenchmarksResponse
      description: Response for listing all benchmarks (similar to Llama Stack format).
  examples:
    BadRequestError:
      summary: Bad request error with status code 400
      value:
        message: The field 'state' is not valid.
        message_code: invalid_value
        trace: b12692e1-8582-4628-88ca-7a13fefb73e2
    AuthenticationError:
      summary: Authentication error with status code 401
      value:
        message: The bearer token is not valid.
        message_code: invalid_auth_token
        trace: b12692e1-8582-4628-88ca-7a13fefb73e2
    AuthorizationError:
      summary: Authorization error with status code 403
      value:
        message: The user does not have access to the endpoint.
        message_code: endpoint_access_forbidden
        trace: b12692e1-8582-4628-88ca-7a13fefb73e2
    NotFoundError:
      summary: Not found error with status code 404
      value:
        message: The resource was not found.
        message_code: not_found
        trace: b12692e1-8582-4628-88ca-7a13fefb73e2
  responses:
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/APIError'
          examples:
            BadRequestError:
              $ref: '#/components/examples/BadRequestError'
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/APIError'
          examples:
            AuthenticationError:
              $ref: '#/components/examples/AuthenticationError'
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/APIError'
          examples:
            AuthorizationError:
              $ref: '#/components/examples/AuthorizationError'
    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/APIError'
          examples:
            NotFoundError:
              $ref: '#/components/examples/NotFoundError'
